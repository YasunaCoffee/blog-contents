---
title: "iMacã§æ©Ÿæ¢°å­¦ç¿’ã‚’å§‹ã‚ã‚‹ãŸã‚ã®TensorFLow 2.0ç’°å¢ƒæ§‹ç¯‰"
emoji: "ğŸ¤—"
type: "tech"
topics:
  - "ai"
  - "tensorflow"
  - "æ©Ÿæ¢°å­¦ç¿’"
  - "huggingface"
published: true
published_at: "2023-09-23 01:30"
---

## ã¯ã˜ã‚ã«
OpenInterpreterã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«å°å…¥ã—ãŸã‚‚ã®ã®ã€ãã‚‚ãã‚‚æ©Ÿæ¢°å­¦ç¿’ã«å¯¾ã—ã¦å…¨ãçŸ¥è­˜ãŒãªã„ã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦æ¬¡ã«ã©ã†ã™ã‚Œã°ã„ã„ã®ã‹æ–¹å‘æ€§ã«æ‚©ã‚“ã§ã„ã¾ã—ãŸã€‚
OpenInterpreterã«ã¤ã„ã¦ã‚„ã£ãŸã“ã¨ã¯ä»¥ä¸‹ã®è¨˜äº‹ã«è©³ã—ã„ã§ã™ã€‚
https://zenn.dev/yasuna/articles/f5f084c1e9f3c0
OpenInterpreterã‚’èª¿ã¹ã¦ã„ã‚‹ä¸­ã§ã€HuggingFaceã¨ã„ã†AIã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‡ºä¼šã„ã¾ã—ãŸã€‚

### HuggingFaceã¯ä»Šä¸–ç•Œä¸­ã§å¤§æ³¨ç›®ã•ã‚Œã¦ã„ã‚‹AIã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
HuggingFaceã¨ã„ã†ã¨ã¦ã‚‚ã‚­ãƒ¥ãƒ¼ãƒˆãªåå‰ã§ã‹ã‚ã„ã„å°è±¡ã‚’å—ã‘ã¾ã—ãŸã€‚
ãŒã€ã¨ã‚“ã§ã‚‚ãªãAIã«å¯¾ã™ã‚‹ç†±é‡ã‚’æ„Ÿã˜ã¾ã—ãŸã€‚

ã“ã‚Œã¯ãŸã ã‚‚ã®ã§ã¯ãªã„ãã€‚ã€‚ã€‚HuggingFaceã«ã¤ã„ã¦ã„ã‹ãªã‘ã‚Œã°ã€‚ã€‚ã€‚

ã¨ã„ã†ç¾©å‹™æ„Ÿã¨ãƒ¯ã‚¯ãƒ¯ã‚¯æ„ŸãŒç”Ÿã¾ã‚Œã¦ãã¾ã—ãŸã€‚
https://huggingface.co/

èª¿ã¹ã¦ã¿ã‚‹ã¨ã€æ©Ÿæ¢°å­¦ç¿’ã‚’å§‹ã‚ã‚‹ãŸã‚ã«ã¯
ã‚¯ãƒ©ã‚¦ãƒ‰ã‹ãƒ­ãƒ¼ã‚«ãƒ«ã§æ©Ÿæ¢°å­¦ç¿’ãŒã§ãã‚‹ç’°å¢ƒã‚’ä½œã£ã¦å‹•ã‹ã•ãªãã¯ãªã‚‰ãªã„ã¨ã®ã“ã¨ã§ã—ãŸã€‚

ä»Šå›ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§æ©Ÿæ¢°å­¦ç¿’ã®ç’°å¢ƒã‚’ä½œã£ã¦ã„ã“ã†ï¼ã¨è€ƒãˆã¾ã—ãŸã€‚

## ä»Šå›å°å…¥ã™ã‚‹PCã‚¹ãƒšãƒƒã‚¯
:::message
iMac Retina 5K, 27-inch, 2020
ãƒ—ãƒ­ã‚»ãƒƒã‚µï¼šã€€3.3 GHz 6ã‚³ã‚¢Intel Core i5
ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼šã€€AMD Radeon Pro 5300 4 GB
ãƒ¡ãƒ¢ãƒªï¼šã€€40 GB 2667 MHz DDR4
OSï¼šã€€Mac OS Ventura 13.5.1
:::

## ãƒ­ãƒ¼ã‚«ãƒ«ã§æ©Ÿæ¢°å­¦ç¿’ã‚’ã™ã‚‹ãŸã‚ã«ä½•ã‹ã‚‰å§‹ã‚ãŸã‚‰ã„ã„ã®ï¼Ÿ
HuggingFaceã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€æ©Ÿæ¢°å­¦ç¿’ã‚’å§‹ã‚ã‚‹ã«ã¯*PyTorch*ã¨*TensorFlow2.0*ã®ã©ã¡ã‚‰ã‹ã‚’å°å…¥ã—ãªã‘ã‚Œã°å§‹ã¾ã‚‰ãªã„ã‚ˆã†ã§ã™ã€‚

ã¡ãªã¿ã«PyTorchã¯Metaç¤¾ãŒé–‹ç™ºã—ãŸã‚‚ã®ã€TensorFLow2.0ã¯Googleç¤¾ãŒé–‹ç™ºã—ãŸã‚‚ã®ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚

>PyTorchã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ§ãƒ³ã‚„è‡ªç„¶è¨€èªå‡¦ç†ã§åˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹Torchã‚’å…ƒã«ä½œã‚‰ã‚ŒãŸã€Pythonã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ã€‚æœ€åˆã¯Facebookã®äººå·¥çŸ¥èƒ½ç ”ç©¶ã‚°ãƒ«ãƒ¼ãƒ—AI Research labã«ã‚ˆã‚Šé–‹ç™ºã•ã‚ŒãŸã€‚(Wiki)

https://pytorch.org/

>TensorFlowã¨ã¯ã€GoogleãŒé–‹ç™ºã—ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã§å…¬é–‹ã—ã¦ã„ã‚‹ã€æ©Ÿæ¢°å­¦ç¿’ã«ç”¨ã„ã‚‹ãŸã‚ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ã€‚(Wiki)

https://www.tensorflow.org/tutorials/quickstart/beginner?hl=ja

ã©ã£ã¡ã‚’å°å…¥ã—ã‚ˆã†ã‹èª¿ã¹ã¦ãŸã¨ã“ã‚ã€TensorFlowã®æ–¹ãŒå¾Œã‚ã§å‡¦ç†ã‚’ã—ã¦ãã‚Œã‚‹ã“ã¨ãŒå¤šãã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãé‡ãŒå°‘ãªã„ã¨ã®ã“ã¨ã ã£ãŸã®ã§ã€å¿ƒãŒæŠ˜ã‚Œãªã„ãŸã‚ã«TensorFlowã‚’å°å…¥ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

## TensorFlow2.0ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ä»¥ä¸‹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã‚’æ—©é€Ÿè¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
https://www.tensorflow.org/install/pip?hl=ja

### MacOSã®GPUã¯TensorFLowå…¬å¼ã‚µãƒãƒ¼ãƒˆå¯¾è±¡å¤–
```
# There is currently no official GPU support for MacOS.
```
å…¬å¼ã«Mac0Sã®GPUãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªãã¦æ®‹å¿µã§ã—ãŸãŒã€ä»Šã‚ã‚‹ç’°å¢ƒã§ã‚‚å°å…¥ã§ããã†ãªã®ã§ã¨ã«ã‹ãã‚„ã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚
ã‚†ãã‚†ãã¯Windowsã«NVIDIAã‚’ä¹—ã£ã‘ã¦ã‚„ã£ã¦ã¿ãŸã„ãªã‚ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã®ï¼’ã¤ã ã‘ã§TensorFlowã¯å°å…¥ã§ãã¾ã—ãŸã€‚ã‚ã£ã¡ã‚ƒç°¡å˜ã§ã™ã€‚
```
# There is currently no official GPU support for MacOS.
python3 -m pip install tensorflow
# Verify install:
python3 -c "import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))"
```

æ¬¡ã«ã€HuggingFaceã‹ã‚‰Transformersã‚’å°å…¥ã—ã¦ã¿ã¾ã™ã€‚

>Transformersã¯ã€APIã¨ãƒ„ãƒ¼ãƒ«ã‚’æä¾›ã—ã€æœ€å…ˆç«¯ã®äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ç°¡å˜ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚(HuggingFaceã‚ˆã‚Š)

https://huggingface.co/docs/transformers/index

ç°¡å˜ã«æ©Ÿæ¢°å­¦ç¿’ã‚’ä½“é¨“ã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¦ã¾ã™ã€‚APIå¤§å¥½ãã€‚

## Transformerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
TensorFlowç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã£ãŸã®ã§ä»Šå›ã¯ã“ã¡ã‚‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚
https://huggingface.co/docs/transformers/installation

ç§ã®å ´åˆã¯hugginfaceã®èª¬æ˜ã ã¨ã†ã¾ãä½œå‹•ã—ãªã‹ã£ãŸã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«python3ã¨ã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰ãˆã‚‹ã¨å‹•ä½œã—ã¾ã—ãŸã€‚
```
python3 -m venv .env
```

ã‚ã¨ã¯å…¬å¼ã®èª¬æ˜ã«æ²¿ã£ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é€²ã‚ã¦ã„ãã ã‘ã§ã™ï¼

å°å…¥ã§ããŸã‚‰ã€æœ€å¾Œã«ãƒ—ãƒ¬ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€å®Ÿéš›ã«å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚

```
% python -c "from transformers import pipeline; print(pipeline('sentiment-analysis')('we love you'))" 

2023-09-23 01:17:04.582969: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
No model was supplied, defaulted to distilbert-base-uncased-finetuned-sst-2-english and revision af0f99b (https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english).
Using a pipeline without specifying a model name and revision in production is not recommended.
All PyTorch model weights were used when initializing TFDistilBertForSequenceClassification.

All the weights of TFDistilBertForSequenceClassification were initialized from the PyTorch model.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFDistilBertForSequenceClassification for predictions without further training.
[{'label': 'POSITIVE', 'score': 0.9998704195022583}]
```

ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’è¦‹ã‚‹ã¨ã€'we love you'ã¨ã„ã†å…¥åŠ›ã®çµæœãŒå‡ºåŠ›ã•ã‚Œã¾ã—ãŸï¼
```
[{'label': 'POSITIVE', 'score': 0.9998704195022583}]
```

## ã¾ã¨ã‚
iMacã§ã‚‚æ©Ÿæ¢°å­¦ç¿’ã®ç’°å¢ƒæ§‹ç¯‰ãŒã‚ã£ã¨ã„ã†é–“ã«ã§ãã¾ã—ãŸã€‚
ç”»åƒå‡¦ç†ãªã©ã¯æ™‚é–“ãŒã‹ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€
ã“ã‚Œã‹ã‚‰è‰²ã‚“ãªæ©Ÿæ¢°å­¦ç¿’ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼

ã“ã®ã‚¹ãƒ ãƒ¼ã‚ºæ„Ÿã€è‰¯ãæœªæ¥ã—ã‹æ„Ÿã˜ã•ã›ãªã„ã§ã™ã­ï¼

ã“ã‚Œã‹ã‚‰æ©Ÿæ¢°å­¦ç¿’ã«ã¤ã„ã¦ã©ã‚“ã©ã‚“ç™ºä¿¡ã—ã¦ã„ã‘ãŸã‚‰ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

